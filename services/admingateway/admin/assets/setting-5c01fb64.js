import{r as b,S as h,l as S,c as i,a as s,u as t,h as P,w as k,d as r,E as c,o as u,j as _,v,t as f,k as m,g as x}from"./index-0818f5f9.js";import{_ as y}from"./dialog-bc66d1c4.js";import{U as M}from"./user-99a27971.js";const j={class:"md-4 app-base"},$=s("ul",{class:"nav nav-underline-border ab-underline-border"},[s("li",{class:"nav-item"},[s("a",{class:"nav-link active jgicon jgicon-product"},"基本信息")])],-1),U={class:"jg-us-table"},C={class:"row jg-ab-row jg-us-row"},D=s("label",{class:"col-sm-1 col-form-label"},"账户名称",-1),N={class:"col-sm-2"},O=["value"],R=s("div",{class:"col-sm-4"},null,-1),V={class:"row jg-ab-row jg-us-row"},I=s("label",{class:"col-sm-1 col-form-label"},"账户密码",-1),T=s("div",{class:"col-sm-2"},[s("input",{class:"form-control-plaintext",type:"text",readonly:"",value:"**** ****"})],-1),W={class:"col-sm-4"},B={class:"row g-2 jg-row"},G={class:"form-floating"},q=["value"],L=s("label",null,"账户名称",-1),A={class:"form-floating"},H=s("label",null,"原密码",-1),K={key:0,class:"invalid-feedback feedback"},z={class:"form-floating"},F=s("label",null,"新密码",-1),J={key:0,class:"invalid-feedback feedback"},ss={__name:"setting",setup(Q){let w=x(),o=b({isShowEdit:!1,user:h.get(S.USER_TOKEN),pwd:"",newPwd:"",pwdErrorMsg:"",newPwdErrorMsg:""});function a(l){o.isShowEdit=l}function p(l){({pwd:()=>{o.pwdErrorMsg=""},newPwd:()=>{o.newPwdErrorMsg=""}})[l]()}function g(){let{newPwd:l,pwd:e,user:n}=o;if(r.isEmpty(e))return o.pwdErrorMsg="原密码不能为空";if(r.isEmpty(l))return o.newPwdErrorMsg="新密码不能为空";M.updatePwd({account:n.account,password:e,new_password:l}).then(({code:d,msg:E})=>{r.isEqual(d,c.SUCCESS_0.code)?(a(!1),w.proxy.$toast({text:"修改成功",icon:"success"})):r.isEqual(d,c.USER_OLDPWD_WRONG.code)?o.newPwdErrorMsg=c.USER_OLDPWD_WRONG.msg:w.proxy.$toast({text:`${d}: ${E}`,icon:"error"})})}return(l,e)=>(u(),i("div",j,[$,s("div",U,[s("div",C,[D,s("div",N,[s("input",{class:"form-control-plaintext",type:"text",readonly:"",value:t(o).user.account},null,8,O)]),R]),s("div",V,[I,T,s("div",W,[s("a",{class:"btn-link jg-btn-link",type:"button",onClick:e[0]||(e[0]=n=>a(!0))},"修改")])])]),P(y,{show:t(o).isShowEdit,title:"修改密码",onHide:e[5]||(e[5]=n=>a(!1)),onSave:e[6]||(e[6]=n=>g())},{default:k(()=>[s("div",B,[s("div",G,[s("input",{class:"form-control",placeholder:"账户名称",value:t(o).user.account,disabled:""},null,8,q),L]),s("div",A,[_(s("input",{class:"form-control",placeholder:"原密码","onUpdate:modelValue":e[1]||(e[1]=n=>t(o).pwd=n),onInput:e[2]||(e[2]=n=>p("pwd"))},null,544),[[v,t(o).pwd]]),H,t(o).pwdErrorMsg?(u(),i("div",K,f(t(o).pwdErrorMsg),1)):m("",!0)]),s("div",z,[_(s("input",{class:"form-control",placeholder:"新密码","onUpdate:modelValue":e[3]||(e[3]=n=>t(o).newPwd=n),onInput:e[4]||(e[4]=n=>p("newPwd"))},null,544),[[v,t(o).newPwd]]),F,t(o).newPwdErrorMsg?(u(),i("div",J,f(t(o).newPwdErrorMsg),1)):m("",!0)])])]),_:1},8,["show"])]))}};export{ss as default};
