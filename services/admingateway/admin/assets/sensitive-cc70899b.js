import{H as q,B as a,i as W,C as l,o as $,c as A,h as t,w as o,I as v,u as M,N as E,A as S,a as H,r as J,J as j,K as U,L as P,M as G}from"./index-fb0c9453.js";function K({title:V="",text:_="",icon:u="success"}){window.$toast({icon:u,text:_,title:V})}const O={__name:"sensitive_data_edit",emits:["reloadTable"],setup(V,{expose:_,emit:u}){const w=u,d=q(),p=a(!1),s=a(!1),r=a(k({})),i=a({}),f=a(!1);let b=W(),{currentRoute:{_rawValue:{params:{app_key:h}}}}=b;const c=[{label:"过滤",value:1},{label:"替换（****）",value:2}];function k(n={}){return{id:n.id||0,word:n.word||"",wordType:n.wordType||1}}function x(){s.value=!0}function T(n){n.preventDefault(),f.value=!0,i.value.validate(e=>{e?d.error("请填写完整信息"):S.addSensitiveWord({app_key:h,word:r.value.word,word_type:r.value.wordType}).then(m=>{K({text:"添加成功"}),w("reloadTable"),s.value=!1}).finally(()=>{f.value=!1})})}function C(){s.value=!1,p.value=!1}return _({openModal:x}),(n,e)=>{const m=l("n-input"),g=l("n-form-item"),y=l("n-gi"),N=l("n-select"),F=l("n-grid"),D=l("n-form"),z=l("n-spin"),L=l("n-scrollbar"),B=l("n-button"),I=l("n-space");return $(),A("div",null,[t(M(E),{show:s.value,"onUpdate:show":e[2]||(e[2]=R=>s.value=R),"mask-closable":!1,"show-icon":!1,preset:"dialog","transform-origin":"center",title:"添加敏感词",style:{width:840}},{action:o(()=>[t(I,null,{default:o(()=>[t(B,{onClick:C},{default:o(()=>e[3]||(e[3]=[v(" 取消")])),_:1}),t(B,{type:"info",loading:f.value,onClick:T},{default:o(()=>e[4]||(e[4]=[v(" 确定")])),_:1},8,["loading"])]),_:1})]),default:o(()=>[t(L,{style:{"max-height":"87vh"},class:"pr-5"},{default:o(()=>[t(z,{show:p.value,description:"请稍候..."},{default:o(()=>[t(D,{ref_key:"formRef",ref:i,model:r.value,"label-placement":"left","label-width":100,class:"py-4"},{default:o(()=>[t(F,{cols:"1 s:1 m:1 l:1 xl:1 2xl:1",responsive:"screen"},{default:o(()=>[t(y,{span:"1"},{default:o(()=>[t(g,{label:"敏感词",path:"word"},{default:o(()=>[t(m,{placeholder:"请输入敏感词",value:r.value.word,"onUpdate:value":e[0]||(e[0]=R=>r.value.word=R)},null,8,["value"])]),_:1})]),_:1}),t(y,{span:"1"},{default:o(()=>[t(g,{label:"过滤类型",path:"wordType"},{default:o(()=>[t(N,{placeholder:"请选择过滤类型",value:r.value.wordType,"onUpdate:value":e[1]||(e[1]=R=>r.value.wordType=R),options:c},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["show"])]),_:1})]),_:1},8,["show"])])}}},Q={__name:"importWords",emits:["reloadTable"],setup(V,{expose:_,emit:u}){const w=u,d=q(),p=a(!1),s=a(!1),r=a({}),i=a({}),f=a(!1);let b=W(),{currentRoute:{_rawValue:{params:{app_key:h}}}}=b,c=null;function k(n){n.target.files.length>0&&(c=n.target.files[0])}function x(){s.value=!0}function T(n){n.preventDefault(),f.value=!0,i.value.validate(e=>{e?d.error("请填写完整信息"):(console.log(c),S.importSensitiveWords(h,c).then(m=>{K({text:"导入成功"}),w("reloadTable"),s.value=!1}).finally(()=>{f.value=!1}))})}function C(){s.value=!1,p.value=!1}return _({openModal:x}),(n,e)=>{const m=l("n-form-item"),g=l("n-gi"),y=l("n-grid"),N=l("n-form"),F=l("n-spin"),D=l("n-scrollbar"),z=l("n-button"),L=l("n-space");return $(),A("div",null,[t(M(E),{show:s.value,"onUpdate:show":e[0]||(e[0]=B=>s.value=B),"mask-closable":!1,"show-icon":!1,preset:"dialog","transform-origin":"center",title:"导入词库",style:{width:840}},{action:o(()=>[t(L,null,{default:o(()=>[t(z,{onClick:C},{default:o(()=>e[1]||(e[1]=[v(" 取消")])),_:1}),t(z,{type:"info",loading:f.value,onClick:T},{default:o(()=>e[2]||(e[2]=[v(" 确定")])),_:1},8,["loading"])]),_:1})]),default:o(()=>[t(D,{style:{"max-height":"87vh"},class:"pr-5"},{default:o(()=>[t(F,{show:p.value,description:"请稍候..."},{default:o(()=>[t(N,{ref_key:"formRef",ref:i,model:r.value,"label-placement":"left","label-width":100,class:"py-4"},{default:o(()=>[t(y,{cols:"1 s:1 m:1 l:1 xl:1 2xl:1",responsive:"screen"},{default:o(()=>[t(g,{span:"1"},{default:o(()=>[t(m,{label:"词库",path:"word"},{default:o(()=>[H("input",{type:"file",onChange:k},null,32)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["show"])]),_:1})]),_:1},8,["show"])])}}},X={class:"tab-content"},Y={style:{"margin-bottom":"10px"}},ee={__name:"sensitive",setup(V){let _=W(),{currentRoute:{_rawValue:{params:{app_key:u}}}}=_,w=J({list:[]});a(0);const d=a(!1),p=a(),s=a(),r=a({word:""});function i(){k({page:1,size:10,app_key:u})}function f(){p.value.openModal()}function b(){s.value.openModal()}const h=a([{title:"词语",key:"word"},{title:"过滤类型",key:"word_type",render(n){return P(G,{type:n.word_type===1?"success":"info"},{default:()=>n.word_type===1?"过滤":"替换（****）"})}},{title:"操作",key:"actions",render(n){return P(U,{strong:!0,tertiary:!0,size:"small",type:"error",onClick:()=>C(n)},{default:()=>"删除"})}}]),c=a({});i();function k(n){d.value=!0,S.getSensitiveList({...n,word:r.value.word||""}).then(e=>{w.list=e.data.items||[],c.value={page:e.data.page,itemCount:e.data.total,pageSize:10}}).finally(()=>{d.value=!1})}function x(n){d.value=!0,S.getSensitiveList({page:n,size:10,appKey:u,word:r.value.word||""}).then(e=>{e.data.list,c.value={page:e.data.page,itemCount:e.data.total,pageSize:10}}).finally(()=>{d.value=!1})}const T=j();function C(n){T.warning({title:"警告",content:"你确定要删除？",positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{S.deleteSensitiveWord({app_key:u,word:n.word}).then(e=>{e.code===0&&K({text:"删除成功"}),i()})}})}return(n,e)=>{const m=l("n-data-table"),g=l("n-card");return $(),A("div",X,[t(g,{bordered:!1,class:"proCard"},{default:o(()=>[H("div",Y,[t(M(U),{type:"primary",size:"small",onClick:f},{default:o(()=>e[0]||(e[0]=[v(" 添加")])),_:1}),e[2]||(e[2]=v("   ")),t(M(U),{type:"default",size:"small",onClick:b},{default:o(()=>e[1]||(e[1]=[v(" 导入词库")])),_:1})]),t(m,{remote:"",ref:"table",columns:h.value,data:M(w).list,loading:d.value,"row-key":y=>y.id,"onUpdate:page":x},null,8,["columns","data","loading","row-key"])]),_:1}),t(O,{ref_key:"editRef",ref:p,onReloadTable:i},null,512),t(Q,{ref_key:"importRef",ref:s,onReloadTable:i},null,512)])}}};export{ee as default};
