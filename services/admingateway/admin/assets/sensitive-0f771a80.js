import{H as q,B as l,i as W,C as n,o as $,c as A,h as e,w as t,I as v,u as M,N as E,A as S,a as H,r as J,J as j,K as U,L as P,M as G}from"./index-0818f5f9.js";function K({title:V="",text:_="",icon:u="success"}){window.$toast({icon:u,text:_,title:V})}const O={__name:"sensitive_data_edit",emits:["reloadTable"],setup(V,{expose:_,emit:u}){const w=u,d=q(),f=l(!1),s=l(!1),r=l(k({})),i=l({}),c=l(!1);let h=W(),{currentRoute:{_rawValue:{params:{app_key:b}}}}=h;const p=[{label:"过滤",value:1},{label:"替换（****）",value:2}];function k(o={}){return{id:o.id||0,word:o.word||"",wordType:o.wordType||1}}function x(){s.value=!0}function T(o){o.preventDefault(),c.value=!0,i.value.validate(a=>{a?d.error("请填写完整信息"):S.addSensitiveWord({app_key:b,word:r.value.word,word_type:r.value.wordType}).then(m=>{K({text:"添加成功"}),w("reloadTable"),s.value=!1}).finally(()=>{c.value=!1})})}function C(){s.value=!1,f.value=!1}return _({openModal:x}),(o,a)=>{const m=n("n-input"),g=n("n-form-item"),y=n("n-gi"),N=n("n-select"),F=n("n-grid"),D=n("n-form"),z=n("n-spin"),L=n("n-scrollbar"),B=n("n-button"),I=n("n-space");return $(),A("div",null,[e(M(E),{show:s.value,"onUpdate:show":a[2]||(a[2]=R=>s.value=R),"mask-closable":!1,"show-icon":!1,preset:"dialog","transform-origin":"center",title:"添加敏感词",style:{width:840}},{action:t(()=>[e(I,null,{default:t(()=>[e(B,{onClick:C},{default:t(()=>[v(" 取消")]),_:1}),e(B,{type:"info",loading:c.value,onClick:T},{default:t(()=>[v(" 确定")]),_:1},8,["loading"])]),_:1})]),default:t(()=>[e(L,{style:{"max-height":"87vh"},class:"pr-5"},{default:t(()=>[e(z,{show:f.value,description:"请稍候..."},{default:t(()=>[e(D,{ref_key:"formRef",ref:i,model:r.value,"label-placement":"left","label-width":100,class:"py-4"},{default:t(()=>[e(F,{cols:"1 s:1 m:1 l:1 xl:1 2xl:1",responsive:"screen"},{default:t(()=>[e(y,{span:"1"},{default:t(()=>[e(g,{label:"敏感词",path:"word"},{default:t(()=>[e(m,{placeholder:"请输入敏感词",value:r.value.word,"onUpdate:value":a[0]||(a[0]=R=>r.value.word=R)},null,8,["value"])]),_:1})]),_:1}),e(y,{span:"1"},{default:t(()=>[e(g,{label:"过滤类型",path:"wordType"},{default:t(()=>[e(N,{placeholder:"请选择过滤类型",value:r.value.wordType,"onUpdate:value":a[1]||(a[1]=R=>r.value.wordType=R),options:p},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["show"])]),_:1})]),_:1},8,["show"])])}}},Q={__name:"importWords",emits:["reloadTable"],setup(V,{expose:_,emit:u}){const w=u,d=q(),f=l(!1),s=l(!1),r=l({}),i=l({}),c=l(!1);let h=W(),{currentRoute:{_rawValue:{params:{app_key:b}}}}=h,p=null;function k(o){o.target.files.length>0&&(p=o.target.files[0])}function x(){s.value=!0}function T(o){o.preventDefault(),c.value=!0,i.value.validate(a=>{a?d.error("请填写完整信息"):(console.log(p),S.importSensitiveWords(b,p).then(m=>{K({text:"导入成功"}),w("reloadTable"),s.value=!1}).finally(()=>{c.value=!1}))})}function C(){s.value=!1,f.value=!1}return _({openModal:x}),(o,a)=>{const m=n("n-form-item"),g=n("n-gi"),y=n("n-grid"),N=n("n-form"),F=n("n-spin"),D=n("n-scrollbar"),z=n("n-button"),L=n("n-space");return $(),A("div",null,[e(M(E),{show:s.value,"onUpdate:show":a[0]||(a[0]=B=>s.value=B),"mask-closable":!1,"show-icon":!1,preset:"dialog","transform-origin":"center",title:"导入词库",style:{width:840}},{action:t(()=>[e(L,null,{default:t(()=>[e(z,{onClick:C},{default:t(()=>[v(" 取消")]),_:1}),e(z,{type:"info",loading:c.value,onClick:T},{default:t(()=>[v(" 确定")]),_:1},8,["loading"])]),_:1})]),default:t(()=>[e(D,{style:{"max-height":"87vh"},class:"pr-5"},{default:t(()=>[e(F,{show:f.value,description:"请稍候..."},{default:t(()=>[e(N,{ref_key:"formRef",ref:i,model:r.value,"label-placement":"left","label-width":100,class:"py-4"},{default:t(()=>[e(y,{cols:"1 s:1 m:1 l:1 xl:1 2xl:1",responsive:"screen"},{default:t(()=>[e(g,{span:"1"},{default:t(()=>[e(m,{label:"词库",path:"word"},{default:t(()=>[H("input",{type:"file",onChange:k},null,32)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["show"])]),_:1})]),_:1},8,["show"])])}}},X={class:"tab-content"},Y={style:{"margin-bottom":"10px"}},ee={__name:"sensitive",setup(V){let _=W(),{currentRoute:{_rawValue:{params:{app_key:u}}}}=_,w=J({list:[]});l(0);const d=l(!1),f=l(),s=l(),r=l({word:""});function i(){k({page:1,size:10,app_key:u})}function c(){f.value.openModal()}function h(){s.value.openModal()}const b=l([{title:"词语",key:"word"},{title:"过滤类型",key:"word_type",render(o){return P(G,{type:o.word_type===1?"success":"info"},{default:()=>o.word_type===1?"过滤":"替换（****）"})}},{title:"操作",key:"actions",render(o){return P(U,{strong:!0,tertiary:!0,size:"small",type:"error",onClick:()=>C(o)},{default:()=>"删除"})}}]),p=l({});i();function k(o){d.value=!0,S.getSensitiveList({...o,word:r.value.word||""}).then(a=>{w.list=a.data.items||[],p.value={page:a.data.page,itemCount:a.data.total,pageSize:10}}).finally(()=>{d.value=!1})}function x(o){d.value=!0,S.getSensitiveList({page:o,size:10,appKey:u,word:r.value.word||""}).then(a=>{a.data.list,p.value={page:a.data.page,itemCount:a.data.total,pageSize:10}}).finally(()=>{d.value=!1})}const T=j();function C(o){T.warning({title:"警告",content:"你确定要删除？",positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{S.deleteSensitiveWord({app_key:u,word:o.word}).then(a=>{a.code===0&&K({text:"删除成功"}),i()})}})}return(o,a)=>{const m=n("n-data-table"),g=n("n-card");return $(),A("div",X,[e(g,{bordered:!1,class:"proCard"},{default:t(()=>[H("div",Y,[e(M(U),{type:"primary",size:"small",onClick:c},{default:t(()=>[v(" 添加")]),_:1}),v("   "),e(M(U),{type:"default",size:"small",onClick:h},{default:t(()=>[v(" 导入词库")]),_:1})]),e(m,{remote:"",ref:"table",columns:b.value,data:M(w).list,loading:d.value,"row-key":y=>y.id,"onUpdate:page":x},null,8,["columns","data","loading","row-key"])]),_:1}),e(O,{ref_key:"editRef",ref:f,onReloadTable:i},null,512),e(Q,{ref_key:"importRef",ref:s,onReloadTable:i},null,512)])}}};export{ee as default};
