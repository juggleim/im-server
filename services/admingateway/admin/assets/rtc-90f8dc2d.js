import{e as o,L as q,r as L,R as k,c as i,b as l,F as R,d as g,u as _,k as U,l as V,h as B,K as T,o as c,x as A,t as E,q as m}from"./index-668b837b.js";import{R as b,_ as F}from"./dialog-3rd-dac85966.js";const H={class:"mb-4 app-base cim-r3-container"},P={class:"cim-r3-body"},z={class:"cim-r3-item"},I={class:"cim-r3-item-header"},K={class:"cim-r3-header-info"},O={class:"cim-r3-item-name"},Y={class:"cim-r3-header-status"},j={key:0,class:"life-status"},G={class:"cim-r3-item-contents"},J={class:"cim-rtc-item-content"},M={key:0,class:"title"},Q={key:1,class:"value"},W={key:2,class:"value unset"},X={class:"cim-r3-item-tools"},Z=["onClick"],ae={__name:"rtc",setup(ee){let $=V(),{currentRoute:{_rawValue:{params:{app_key:x}}}}=$;const p=B();let S=o.clone(q),f={},n=L({list:[],current:S[0],isShowDialog:!1});function v(r,t){n.isShowDialog=r,r&&(n.current=t)}function w(r){let{uid:t,fields:a}=r,s={},e={};o.forEach(a,u=>{let{key:h,value:d}=u;e[h]=d}),s[t]=e,o.isEqual(T.ENABLE,e.is_used)&&(s.channel=t,o.forEach(n.list,u=>{u.isUsed=o.isEqual(u.uid,t)})),delete s[t].is_used,o.extend(f,s),D(f,s)}function D(r,t){b.setRTC({app_key:x,conf:r}).then(a=>{let{code:s,data:e}=a;if(!o.isEqual(s,k.SUCCESS))return p.proxy.$toast({icon:"error",text:`添加失败: ${s}`});p.proxy.$toast({icon:"success",text:"操作成功"}),C(t),v(!1)})}b.getRTC({app_key:x}).then(r=>{let{code:t,data:a}=r;if(!o.isEqual(t,k.SUCCESS))return p.proxy.$toast({icon:"error",text:`获取配置失败: ${t}`});f=o.clone(a),C(a,!0)});function C(r,t){let{channel:a}=r;o.forEach(S,s=>{let e=o.isEqual(s.uid,a),{uid:u,children:h}=s,d=r[u]||{};o.isEmpty(d)&&!t||(s.children=o.map(h,y=>{let{key:N}=y;return y.value=d[N]||"",y}),e&&(n.current=s),o.extend(s,{isUsed:e}),t&&n.list.push(s))})}return(r,t)=>(c(),i("div",H,[l("ul",P,[(c(!0),i(R,null,g(_(n).list,(a,s)=>(c(),i("li",z,[l("div",I,[l("div",K,[l("div",{class:A(["cim-r3-avatar",[a.icon+"-avatar"]])},null,2),l("div",O,E(a.name),1)]),l("div",Y,[a.children[0].value?(c(),i("span",j,"【已启用】")):m("",!0)])]),l("ul",G,[(c(!0),i(R,null,g(a.children,e=>(c(),i("li",J,[e.type=="text"||e.type=="number"?(c(),i("div",M,E(e.name)+":",1)):m("",!0),(e.type=="text"||e.type=="number")&&e.value?(c(),i("div",Q,E(e.secretValue||e.value),1)):m("",!0),(e.type=="text"||e.type=="number")&&!e.value?(c(),i("div",W,"未设置")):m("",!0)]))),256))]),l("ul",X,[l("li",{class:"cim-r3-item-tool cicon wr-update",onClick:e=>v(!0,a)},"设置",8,Z)])]))),256))]),U(F,{show:_(n).isShowDialog,title:"音视频设置",custom:"音视频通道",channel:_(n).current,list:_(n).list,onSave:w,onHide:t[0]||(t[0]=a=>v(!1))},null,8,["show","channel","list"])]))}};export{ae as default};
