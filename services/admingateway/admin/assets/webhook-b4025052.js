import{A as m,e as l,r as x,c as n,b as e,p as _,v as b,u as i,F as p,d as h,l as w,o as a,t as v,h as y}from"./index-668b837b.js";const E={class:"mb-4 app-base cim-cb-box"},C={class:"row cim-cb-row cim-cb-header"},V={class:"cim-cb-form"},B={class:"col-sm-7"},H={class:"row cim-cb-row cim-cb-body"},A={class:"cim-cb-group"},D={class:"cim-cb-group-title"},F={class:"cim-cb-group-content"},N={class:"cim-form-check form-switch"},R={class:"form-check-label"},S=["checked","id"],I={__name:"webhook",setup(U){let f=w(),{currentRoute:{_rawValue:{params:{app_key:u}}}}=f;const g=y();m.getEventHook({app_key:u}).then(({data:c={}})=>{let{event_sub_config:t,event_sub_switch:s}=c;l.extend(o,{config:t,hooks:s})});let o=x({hooks:[],config:{}});function k(c){l.forEach(o.hooks,t=>{l.forEach(t.items,s=>{l.isEqual(s.key,c.target.id)&&(s.value=Number(c.target.checked))})}),d()}function d(){let{config:c,hooks:t}=o;m.setEventHook({app_key:u,config:c,hooks:t}).then(()=>{g.proxy.$toast({icon:"success",text:"保存成功"})})}return(c,t)=>(a(),n("div",E,[e("div",C,[e("div",V,[t[2]||(t[2]=e("label",{class:"col-sm-1 col-form-label"},[e("div",{class:"cim-cb-input-item"},"设置事件地址"),e("div",{class:"cim-cb-input-item"},"设置鉴权凭证")],-1)),e("div",B,[_(e("input",{class:"form-control cim-cb-input-item",type:"text","onUpdate:modelValue":t[0]||(t[0]=s=>i(o).config.event_sub_url=s),placeholder:"请输入事件地址"},null,512),[[b,i(o).config.event_sub_url]]),_(e("input",{class:"form-control cim-cb-input-item",type:"text","onUpdate:modelValue":t[1]||(t[1]=s=>i(o).config.event_sub_auth=s),placeholder:"请输入鉴权凭证，凭证会与事件一起回调给业务服务器"},null,512),[[b,i(o).config.event_sub_auth]])]),e("div",{class:"col-sm-3 cim-cb-btns"},[e("div",{class:"cim-button cim-button-bg",onClick:d},"保存")])])]),e("div",H,[(a(!0),n(p,null,h(i(o).hooks,s=>(a(),n("div",A,[e("div",D,v(s.name),1),e("div",F,[(a(!0),n(p,null,h(s.items,r=>(a(),n("div",N,[e("label",R,v(r.name),1),e("input",{class:"form-check-input",type:"checkbox",checked:r.value,id:r.key,onChange:k},null,40,S)]))),256))])]))),256))])]))}};export{I as default};
