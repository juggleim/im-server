import{e as o,T as A,r as L,R as y,c as i,b as c,F as g,d as b,u as p,k as V,l as B,h as F,K as H,o as l,x as P,t as S,q as f}from"./index-668b837b.js";import{R as k,_ as z}from"./dialog-3rd-dac85966.js";const I={class:"mb-4 app-base cim-r3-container"},K={class:"cim-r3-body"},O={class:"cim-r3-item"},Y={class:"cim-r3-item-header"},j={class:"cim-r3-header-info"},G={class:"cim-r3-item-name"},J={class:"cim-r3-header-status"},M={key:0,class:"life-status"},Q={key:1,class:"life-unuse-status"},W={class:"cim-r3-item-contents"},X={class:"cim-rtc-item-content"},Z={key:0,class:"title"},ee={key:1,class:"value"},te={key:2,class:"value unset"},se={class:"cim-r3-item-tools"},ae=["onClick"],ne=["onClick"],oe=["onClick"],ce={__name:"translate",setup(ie){let w=B(),{currentRoute:{_rawValue:{params:{app_key:v}}}}=w;const _=F();let C=o.clone(A),u={},r=L({list:[],current:C[0],isShowDialog:!1});function h(s,t){r.isShowDialog=s,s&&(r.current=t)}function T(s){let{uid:t,fields:e}=s,n={},a={};o.forEach(e,d=>{let{key:x,value:m}=d;a[x]=m}),n[t]=a,o.isEqual(H.ENABLE,a.is_used)&&(n.channel=t,o.forEach(r.list,d=>{d.isUsed=o.isEqual(d.uid,t)})),delete n[t].is_used,o.extend(u,n),D(u,n)}function D(s,t){k.setTranslate({app_key:v,conf:s}).then(e=>{let{code:n,data:a}=e;if(!o.isEqual(n,y.SUCCESS))return _.proxy.$toast({icon:"error",text:`添加失败: ${n}`});_.proxy.$toast({icon:"success",text:"操作成功"}),U(t),h(!1)})}function $(s){k.setTranslate({app_key:v,conf:s}).then(t=>{let{code:e,data:n}=t;if(!o.isEqual(e,y.SUCCESS))return _.proxy.$toast({icon:"error",text:`修改失败: ${e}`});_.proxy.$toast({icon:"success",text:"操作成功"}),h(!1)})}k.getTranslate({app_key:v}).then(s=>{let{code:t,data:e}=s;if(!o.isEqual(t,y.SUCCESS))return _.proxy.$toast({icon:"error",text:`获取配置失败: ${t}`});u=o.clone(e),U(e,!0)});function U(s,t){let{channel:e}=s;o.forEach(C,n=>{let a=o.isEqual(n.uid,e),{uid:d,children:x}=n,m=s[d]||{};o.isEmpty(m)&&!t||(n.children=o.map(x,E=>{let{key:q}=E;return E.value=m[q]||"",E}),a&&(r.current=n),o.extend(n,{isUsed:a}),t&&r.list.push(n))})}function N(s,t){s.isUsed=!1,o.extend(u,{channel:""}),$(u)}function R(s,t){o.forEach(r.list,e=>{e.isUsed=!1}),s.isUsed=!0,o.extend(u,{channel:s.uid}),$(u)}return(s,t)=>(l(),i("div",I,[c("ul",K,[(l(!0),i(g,null,b(p(r).list,(e,n)=>(l(),i("li",O,[c("div",Y,[c("div",j,[c("div",{class:P(["cim-r3-avatar",[e.icon+"-avatar"]])},null,2),c("div",G,S(e.name),1)]),c("div",J,[e.isUsed?(l(),i("span",M,"【已启用】")):(l(),i("span",Q,"【未启用】"))])]),c("ul",W,[(l(!0),i(g,null,b(e.children,a=>(l(),i("li",X,[a.type=="text"?(l(),i("div",Z,S(a.name)+":",1)):f("",!0),a.type=="text"&&a.value?(l(),i("div",ee,S(a.secretValue||a.value),1)):f("",!0),a.type=="text"&&!a.value?(l(),i("div",te,"未设置")):f("",!0)]))),256))]),c("ul",se,[c("li",{class:"cim-r3-item-tool cicon wr-update",onClick:a=>h(!0,e)},"设置",8,ae),e.isUsed?(l(),i("li",{key:0,class:"cim-r3-item-tool cicon wr-disable",onClick:a=>N(e)},"停用",8,ne)):f("",!0),!e.isUsed&&e.children[0].value.length>0?(l(),i("li",{key:1,class:"cim-r3-item-tool cicon wr-enable",onClick:a=>R(e)},"启用",8,oe)):f("",!0)])]))),256))]),V(z,{show:p(r).isShowDialog,title:"翻译设置",custom:"翻译通道",channel:p(r).current,list:p(r).list,onSave:T,onHide:t[0]||(t[0]=e=>h(!1))},null,8,["show","channel","list"])]))}};export{ce as default};
