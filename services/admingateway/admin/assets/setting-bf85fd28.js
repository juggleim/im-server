import{r as _,S,l as P,c as i,a as o,u as e,h as k,w as x,d as r,E as u,o as w,j as c,v as f,t as m,k as g,g as y}from"./index-fb0c9453.js";import{_ as M}from"./dialog-61be0fc3.js";import{U as j}from"./user-90d42ed6.js";const $={class:"md-4 app-base"},U={class:"jg-us-table"},C={class:"row jg-ab-row jg-us-row"},D={class:"col-sm-2"},N=["value"],O={class:"row jg-ab-row jg-us-row"},R={class:"col-sm-4"},V={class:"row g-2 jg-row"},I={class:"form-floating"},T=["value"],W={class:"form-floating"},B={key:0,class:"invalid-feedback feedback"},G={class:"form-floating"},q={key:0,class:"invalid-feedback feedback"},z={__name:"setting",setup(L){let p=y(),t=_({isShowEdit:!1,user:S.get(P.USER_TOKEN),pwd:"",newPwd:"",pwdErrorMsg:"",newPwdErrorMsg:""});function a(n){t.isShowEdit=n}function v(n){({pwd:()=>{t.pwdErrorMsg=""},newPwd:()=>{t.newPwdErrorMsg=""}})[n]()}function E(){let{newPwd:n,pwd:s,user:l}=t;if(r.isEmpty(s))return t.pwdErrorMsg="原密码不能为空";if(r.isEmpty(n))return t.newPwdErrorMsg="新密码不能为空";j.updatePwd({account:l.account,password:s,new_password:n}).then(({code:d,msg:b})=>{r.isEqual(d,u.SUCCESS_0.code)?(a(!1),p.proxy.$toast({text:"修改成功",icon:"success"})):r.isEqual(d,u.USER_OLDPWD_WRONG.code)?t.newPwdErrorMsg=u.USER_OLDPWD_WRONG.msg:p.proxy.$toast({text:`${d}: ${b}`,icon:"error"})})}return(n,s)=>(w(),i("div",$,[s[14]||(s[14]=o("ul",{class:"nav nav-underline-border ab-underline-border"},[o("li",{class:"nav-item"},[o("a",{class:"nav-link active jgicon jgicon-product"},"基本信息")])],-1)),o("div",U,[o("div",C,[s[7]||(s[7]=o("label",{class:"col-sm-1 col-form-label"},"账户名称",-1)),o("div",D,[o("input",{class:"form-control-plaintext",type:"text",readonly:"",value:e(t).user.account},null,8,N)]),s[8]||(s[8]=o("div",{class:"col-sm-4"},null,-1))]),o("div",O,[s[9]||(s[9]=o("label",{class:"col-sm-1 col-form-label"},"账户密码",-1)),s[10]||(s[10]=o("div",{class:"col-sm-2"},[o("input",{class:"form-control-plaintext",type:"text",readonly:"",value:"**** ****"})],-1)),o("div",R,[o("a",{class:"btn-link jg-btn-link",type:"button",onClick:s[0]||(s[0]=l=>a(!0))},"修改")])])]),k(M,{show:e(t).isShowEdit,title:"修改密码",onHide:s[5]||(s[5]=l=>a(!1)),onSave:s[6]||(s[6]=l=>E())},{default:x(()=>[o("div",V,[o("div",I,[o("input",{class:"form-control",placeholder:"账户名称",value:e(t).user.account,disabled:""},null,8,T),s[11]||(s[11]=o("label",null,"账户名称",-1))]),o("div",W,[c(o("input",{class:"form-control",placeholder:"原密码","onUpdate:modelValue":s[1]||(s[1]=l=>e(t).pwd=l),onInput:s[2]||(s[2]=l=>v("pwd"))},null,544),[[f,e(t).pwd]]),s[12]||(s[12]=o("label",null,"原密码",-1)),e(t).pwdErrorMsg?(w(),i("div",B,m(e(t).pwdErrorMsg),1)):g("",!0)]),o("div",G,[c(o("input",{class:"form-control",placeholder:"新密码","onUpdate:modelValue":s[3]||(s[3]=l=>e(t).newPwd=l),onInput:s[4]||(s[4]=l=>v("newPwd"))},null,544),[[f,e(t).newPwd]]),s[13]||(s[13]=o("label",null,"新密码",-1)),e(t).newPwdErrorMsg?(w(),i("div",q,m(e(t).newPwdErrorMsg),1)):g("",!0)])])]),_:1},8,["show"])]))}};export{z as default};
