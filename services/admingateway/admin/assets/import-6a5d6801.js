import{r as C,e as l,c as i,b as s,F as M,d as S,u as r,k as x,w as $,_ as j,l as K,A as v,i as V,o as d,t as a,p as b,v as g,q as E,h as A,j as T}from"./index-668b837b.js";const B={class:"mb-4"},I={class:"header cim-header"},L={class:"table cim-table"},D={class:"jd-td-c"},N={class:"jd-td-c"},U={class:"jd-td-c"},q={class:"jd-td-c"},F=["onClick"],W={class:"row g-2 cim-row"},H={class:"form-floating"},R={key:0,class:"invalid-feedback feedback"},z={class:"form-floating"},G={key:0,class:"invalid-feedback feedback"},P={__name:"import",setup(J){let y=A(),h=K(),c={name:"",licenseKey:""},n=C({apps:[],isShowEdit:!1,nameErrorMsg:"",licenseErrorMsg:"",app:l.clone(c)});function p(o){n.isShowEdit=o}function m(){let{app:o}=n;if(l.isEmpty(o.name))return n.nameErrorMsg="名称不能为空";if(l.isEmpty(o.licenseKey))return n.licenseErrorMsg="授权不能为空";v.create(o).then(({code:e,msg:t})=>{let u="error",f=`导入失败 ${t}`;l.isEqual(e,V.SUCCESS_0.code)&&(u="success",f="创建成功",n.apps.push(o),n.app=l.clone(c)),y.proxy.$toast({icon:u,text:f,duration:4e3})})}function k(){v.getList().then(({data:{items:o}})=>{let e=o.map(t=>(t.created_time=l.formatTime(t.created_time),t.ended_time=l.formatTime(t.ended_time),t.cur_user_count=l.numberWithCommas(t.cur_user_count),t.max_user_count=l.numberWithCommas(t.max_user_count),t));n.apps=e})}k();function _(){n.nameErrorMsg="",n.licenseErrorMsg=""}function w(o){T.setCurrent(o),h.push({name:"ArguBase",params:{app_key:o.app_key}})}return(o,e)=>(d(),i("div",B,[s("div",I,[e[8]||(e[8]=s("div",{class:"cim-title"},"应用列表",-1)),s("div",{class:"cicon cicon-add cim-button cim-button-bg",onClick:e[0]||(e[0]=t=>p(!0)),onSave:e[1]||(e[1]=t=>m())},"导入应用",32)]),s("table",L,[e[9]||(e[9]=s("thead",null,[s("tr",null,[s("th",null,"应用名称"),s("th",{class:"jd-td-c"},"已使用授权数量"),s("th",{class:"jd-td-c"},"未使用授权数量"),s("th",{class:"jd-td-c"},"到期时间"),s("th",{class:"jd-td-c"},"创建时间"),s("th",null,"操作")])],-1)),s("tbody",null,[(d(!0),i(M,null,S(r(n).apps,t=>(d(),i("tr",null,[s("td",null,a(t.app_name),1),s("td",D,a(t.cur_user_count),1),s("td",N,a(t.max_user_count),1),s("td",U,a(t.ended_time),1),s("td",q,a(t.created_time),1),s("td",null,[s("a",{class:"btn-link cim-btn-link",type:"button",onClick:u=>w(t)},"查看",8,F)])]))),256))])]),x(j,{show:r(n).isShowEdit,title:"导入应用",onHide:e[6]||(e[6]=t=>p(!1)),onSave:e[7]||(e[7]=t=>m())},{default:$(()=>[s("div",W,[s("div",H,[b(s("input",{class:"form-control","onUpdate:modelValue":e[2]||(e[2]=t=>r(n).app.name=t),placeholder:"应用名称",onInput:e[3]||(e[3]=t=>_())},null,544),[[g,r(n).app.name]]),e[10]||(e[10]=s("label",null,"应用名称",-1)),r(n).nameErrorMsg?(d(),i("div",R,a(r(n).nameErrorMsg),1)):E("",!0)]),s("div",z,[b(s("input",{class:"form-control","onUpdate:modelValue":e[4]||(e[4]=t=>r(n).app.licenseKey=t),placeholder:"License Key",onInput:e[5]||(e[5]=t=>_())},null,544),[[g,r(n).app.licenseKey]]),e[11]||(e[11]=s("label",null,"License Key",-1)),r(n).licenseErrorMsg?(d(),i("div",G,a(r(n).licenseErrorMsg),1)):E("",!0)])])]),_:1},8,["show"])]))}};export{P as default};
