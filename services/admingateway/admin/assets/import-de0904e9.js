import{r as w,d as a,c as i,a as s,F as C,b as M,u as r,h as S,w as x,i as $,A as g,E as K,o as d,t as l,j as v,v as E,k as b,g as V,f as A}from"./index-e9cb22d4.js";import{_ as T}from"./dialog-0f3a1928.js";const B={class:"mb-4"},I={class:"header jg-header"},L={class:"table jg-table"},D={class:"jd-td-c"},N={class:"jd-td-c"},U={class:"jd-td-c"},F={class:"jd-td-c"},W=["onClick"],q={class:"row g-2 jg-row"},H={class:"form-floating"},R={key:0,class:"invalid-feedback feedback"},z={class:"form-floating"},G={key:0,class:"invalid-feedback feedback"},Q={__name:"import",setup(J){let j=V(),y=$(),c={name:"",licenseKey:""},n=w({apps:[],isShowEdit:!1,nameErrorMsg:"",licenseErrorMsg:"",app:a.clone(c)});function p(o){n.isShowEdit=o}function m(){let{app:o}=n;if(a.isEmpty(o.name))return n.nameErrorMsg="名称不能为空";if(a.isEmpty(o.licenseKey))return n.licenseErrorMsg="授权不能为空";g.create(o).then(({code:e,msg:t})=>{let u="error",f=`导入失败 ${t}`;a.isEqual(e,K.SUCCESS_0.code)&&(u="success",f="创建成功",n.apps.push(o),n.app=a.clone(c)),j.proxy.$toast({icon:u,text:f,duration:4e3})})}function h(){g.getList().then(({data:{items:o}})=>{let e=o.map(t=>(t.created_time=a.formatTime(t.created_time),t.ended_time=a.formatTime(t.ended_time),t.cur_user_count=a.numberWithCommas(t.cur_user_count),t.max_user_count=a.numberWithCommas(t.max_user_count),t));n.apps=e})}h();function _(){n.nameErrorMsg="",n.licenseErrorMsg=""}function k(o){A.setCurrent(o),y.push({name:"ArguBase",params:{app_key:o.app_key}})}return(o,e)=>(d(),i("div",B,[s("div",I,[e[8]||(e[8]=s("div",{class:"jg-title"},"应用列表",-1)),s("div",{class:"jgicon jgicon-add jg-button jg-button-bg",onClick:e[0]||(e[0]=t=>p(!0)),onSave:e[1]||(e[1]=t=>m())},"导入应用",32)]),s("table",L,[e[9]||(e[9]=s("thead",null,[s("tr",null,[s("th",null,"应用名称"),s("th",{class:"jd-td-c"},"已使用授权数量"),s("th",{class:"jd-td-c"},"未使用授权数量"),s("th",{class:"jd-td-c"},"到期时间"),s("th",{class:"jd-td-c"},"创建时间"),s("th",null,"操作")])],-1)),s("tbody",null,[(d(!0),i(C,null,M(r(n).apps,t=>(d(),i("tr",null,[s("td",null,l(t.app_name),1),s("td",D,l(t.cur_user_count),1),s("td",N,l(t.max_user_count),1),s("td",U,l(t.ended_time),1),s("td",F,l(t.created_time),1),s("td",null,[s("a",{class:"btn-link jg-btn-link",type:"button",onClick:u=>k(t)},"查看",8,W)])]))),256))])]),S(T,{show:r(n).isShowEdit,title:"导入应用",onHide:e[6]||(e[6]=t=>p(!1)),onSave:e[7]||(e[7]=t=>m())},{default:x(()=>[s("div",q,[s("div",H,[v(s("input",{class:"form-control","onUpdate:modelValue":e[2]||(e[2]=t=>r(n).app.name=t),placeholder:"应用名称",onInput:e[3]||(e[3]=t=>_())},null,544),[[E,r(n).app.name]]),e[10]||(e[10]=s("label",null,"应用名称",-1)),r(n).nameErrorMsg?(d(),i("div",R,l(r(n).nameErrorMsg),1)):b("",!0)]),s("div",z,[v(s("input",{class:"form-control","onUpdate:modelValue":e[4]||(e[4]=t=>r(n).app.licenseKey=t),placeholder:"License Key",onInput:e[5]||(e[5]=t=>_())},null,544),[[E,r(n).app.licenseKey]]),e[11]||(e[11]=s("label",null,"License Key",-1)),r(n).licenseErrorMsg?(d(),i("div",G,l(r(n).licenseErrorMsg),1)):b("",!0)])])]),_:1},8,["show"])]))}};export{Q as default};
