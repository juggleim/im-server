import{r as _,S,a as P,c as d,b as o,u as e,k,w as x,_ as y,e as r,i as u,o as w,p as m,v,t as f,q as E,h as M}from"./index-668b837b.js";import{U as $}from"./user-61c5e865.js";const U={class:"md-4 app-base"},C={class:"cim-us-table"},D={class:"row cim-ab-row cim-us-row"},N={class:"col-sm-2"},O=["value"],R={class:"row cim-ab-row cim-us-row"},V={class:"col-sm-4"},I={class:"row g-2 cim-row"},T={class:"form-floating"},W=["value"],q={class:"form-floating"},B={key:0,class:"invalid-feedback feedback"},G={class:"form-floating"},L={key:0,class:"invalid-feedback feedback"},j={__name:"setting",setup(A){let p=M(),t=_({isShowEdit:!1,user:S.get(P.USER_TOKEN),pwd:"",newPwd:"",pwdErrorMsg:"",newPwdErrorMsg:""});function i(n){t.isShowEdit=n}function c(n){({pwd:()=>{t.pwdErrorMsg=""},newPwd:()=>{t.newPwdErrorMsg=""}})[n]()}function b(){let{newPwd:n,pwd:s,user:l}=t;if(r.isEmpty(s))return t.pwdErrorMsg="原密码不能为空";if(r.isEmpty(n))return t.newPwdErrorMsg="新密码不能为空";$.updatePwd({account:l.account,password:s,new_password:n}).then(({code:a,msg:g})=>{r.isEqual(a,u.SUCCESS_0.code)?(i(!1),p.proxy.$toast({text:"修改成功",icon:"success"})):r.isEqual(a,u.USER_OLDPWD_WRONG.code)?t.newPwdErrorMsg=u.USER_OLDPWD_WRONG.msg:p.proxy.$toast({text:`${a}: ${g}`,icon:"error"})})}return(n,s)=>(w(),d("div",U,[s[14]||(s[14]=o("ul",{class:"nav nav-underline-border ab-underline-border"},[o("li",{class:"nav-item"},[o("a",{class:"nav-link active cicon cicon-product"},"基本信息")])],-1)),o("div",C,[o("div",D,[s[7]||(s[7]=o("label",{class:"col-sm-1 col-form-label"},"账户名称",-1)),o("div",N,[o("input",{class:"form-control-plaintext",type:"text",readonly:"",value:e(t).user.account},null,8,O)]),s[8]||(s[8]=o("div",{class:"col-sm-4"},null,-1))]),o("div",R,[s[9]||(s[9]=o("label",{class:"col-sm-1 col-form-label"},"账户密码",-1)),s[10]||(s[10]=o("div",{class:"col-sm-2"},[o("input",{class:"form-control-plaintext",type:"text",readonly:"",value:"**** ****"})],-1)),o("div",V,[o("a",{class:"btn-link cim-btn-link",type:"button",onClick:s[0]||(s[0]=l=>i(!0))},"修改")])])]),k(y,{show:e(t).isShowEdit,title:"修改密码",onHide:s[5]||(s[5]=l=>i(!1)),onSave:s[6]||(s[6]=l=>b())},{default:x(()=>[o("div",I,[o("div",T,[o("input",{class:"form-control",placeholder:"账户名称",value:e(t).user.account,disabled:""},null,8,W),s[11]||(s[11]=o("label",null,"账户名称",-1))]),o("div",q,[m(o("input",{class:"form-control",placeholder:"原密码","onUpdate:modelValue":s[1]||(s[1]=l=>e(t).pwd=l),onInput:s[2]||(s[2]=l=>c("pwd"))},null,544),[[v,e(t).pwd]]),s[12]||(s[12]=o("label",null,"原密码",-1)),e(t).pwdErrorMsg?(w(),d("div",B,f(e(t).pwdErrorMsg),1)):E("",!0)]),o("div",G,[m(o("input",{class:"form-control",placeholder:"新密码","onUpdate:modelValue":s[3]||(s[3]=l=>e(t).newPwd=l),onInput:s[4]||(s[4]=l=>c("newPwd"))},null,544),[[v,e(t).newPwd]]),s[13]||(s[13]=o("label",null,"新密码",-1)),e(t).newPwdErrorMsg?(w(),d("div",L,f(e(t).newPwdErrorMsg),1)):E("",!0)])])]),_:1},8,["show"])]))}};export{j as default};
